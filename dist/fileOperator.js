var validArgs=function(){for(var t=[],e=PPx.Arguments;!e.atEnd();e.moveNext())t.push(e.value);return t},t={actions:"S_ppm#actions",event:"S_ppm#event",global:"S_ppm#global",sources:"S_ppm#sources",staymode:"S_ppm#staymode",user:"S_ppm#user"},isEmptyStr=function(t){return""===t},e=t.event,r={set:function(t,r){PPx.Execute("*setcust "+e+":"+t+"=%("+r+"%)")},unset:function(t){var r=PPx.Extract("%*getcust("+e+":"+t+")");!isEmptyStr(r)&&PPx.Execute("*deletecust "+e+":"+t)},"do":function(t){var r=PPx.Extract("%*getcust("+e+":"+t+")");!isEmptyStr(r)&&PPx.Execute(r)},once:function(t){var r=PPx.Extract("%*getcust("+e+":"+t+")");isEmptyStr(r)||(PPx.Execute(r),PPx.Execute("*deletecust "+e+":"+t))}},pathSelf=function(){var t,e,r=PPx.ScriptName;return~r.indexOf("\\")?(t=extractFileName(r),e=PPx.Extract("%*name(DKN,"+r+")")):(t=r,e=PPx.Extract("%FDN")),{scriptName:t,parentDir:e.replace(/\\$/,"")}},extractFileName=function(t,e){return void 0===e&&(e="\\"),"\\"!==e&&"/"!==e&&(e="\\"),t.slice(t.lastIndexOf(e)+1)};Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var r;if(null==this)throw new Error('Array.indexOf: "this" is null or not defined');var n=Object(this),a=n.length>>>0;if(0===a)return-1;var c=null!=e?e:0;if(Math.abs(c)===Infinity&&(c=0),c>=a)return-1;for(r=Math.max(c>=0?c:a-Math.abs(c),0);r<a;){if(r in n&&n[r]===t)return r;r++}return-1});var n="Drives",a=function(t){t=~t.indexOf(".")?t.slice(0,t.indexOf(".")):t;var e=Number(PPx.Extract("%*getcust(S_ppm#staymode:"+t+")"));return!isNaN(e)&&e>1e4&&e}("workerRclone")||80110,getRemotePath=function(t){var e=PPx.Extract(t);return e.slice(e.indexOf(n)+n.length+1)},c="DoneStackPPb",main=function(){var e=validArgs(),x=e[0],P=e[1],i="1"===x,s="1"===e[2],o=u[P](s),p=o[0],f=o[1],d=o[2],l=PPx.Extract("%*getcust(_IDpwd:"+n+")");if(isEmptyStr(l)||(l='--password-command="echo %*pass" '),!isEmptyStr(f)){if(!i)return p&&PPx.Execute("*execute "+d+',*js ":'+a+',ppx_SetValue",regenerate,1'),"transfer"===P&&PPx.Execute('*execute %~n,*js ":'+a+',ppx_SetValue",regenerate,1'),PPx.Extract("rclone "+l+f);var m=isEmptyStr(PPx.Extract("%*getcust("+t.event+":"+c+")"));if(p&&m){var v=[PPx.Extract("%n"),PPx.Extract("%~n")],E=v[0],h=v[1],g=[PPx.Extract('%*extract(%n,"%%FD")'),PPx.Extract("%~FD")],y=g[0],D=g[1];r.set(c,"%Obd *ppb -c *script "+pathSelf().parentDir+"\\updateEntries.js,"+E+","+h+","+y+","+D)}PPx.Execute("*execute "+d+",*script %sgu'ppmlib'\\stackPPb.stay.js,%*stackwidth,%*stackdirection,rclone "+l+f)}return""},u={rename:function(){return[!1,'moveto -P "'+getRemotePath("%*path")+'" "'+getRemotePath("%*dest")+'"',"%n"]},transfer:function(t){var e=getRemotePath("%*path")+"%*addchar(/)%*src",r=":DIR"===PPx.GetFileInformation(e)?extractFileName(e):"";return[!0,(t?"move":"copy")+' -P "'+e+'" "'+(getRemotePath("%*dest")+"%*addchar(/)"+r)+'"',"%n"]},get:function(t){return[t,(t?"move":"copy")+' -P "'+(getRemotePath("%*path")+"%*addchar(/)%*src")+'" "'+'%*name(D,"%*dest")'+'"',"%n"]},store:function(t){var e=PPx.Extract("%*src"),r=":DIR"===PPx.GetFileInformation(e)?extractFileName(e):"",n=getRemotePath("%*path%*addchar(/)"+r),c=t?"move":"copy";return["1"===PPx.Extract('%*extract(%~n,"%%*stayinfo('+a+')")'),c+' -P "'+e+'" "'+n+'"',"%~n"]},mkdir:function(){return[!0,'mkdir -P "'+getRemotePath("%*path")+'"',"%n"]},"delete":function(t){return[!0,(t?"rmdirs":"delete")+' -P "'+getRemotePath("%*path")+'"',"%n"]}};PPx.result=main();
